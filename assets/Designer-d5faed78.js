import{r as n,a,j as e,R as V,F as q}from"./index-ddca7d0d.js";import{f as H,N as z,r as v,e as D,u as S,h as R,_ as p,d as b,b as f,c as w,y as G}from"./Nav-800e8ee1.js";import{M as J,B as K}from"./App-e2da4e98.js";import{T as Q}from"./Typography-f54fc183.js";import"./TransitionGroupContext-19e7de77.js";function W({setDesignerData:c}){const x=async()=>{try{return H.collection("DesignerPage").orderBy("prio","desc").onSnapshot(u=>{const y=u.docs.map(h=>({id:h.id,...h.data()}));c(y)})}catch(i){console.error("Error fetching designer data:",i)}};n.useEffect(()=>{x()},[])}function X(){return a("div",{className:"border-yellow-500 border-t-2 mt-3",children:[e("h1",{className:"mt-5 mb-5 ml-2",children:"Squarelion Designer Page"}),e("h6",{className:"fixed bottom-1 left-2 text-[10px]",children:"V 0.1"}),a("div",{className:"flex flex-row items-center gap-4 ml-2",children:[e("li",{children:"Step 1 : Click choose file to upload image"}),e("li",{children:"Step 2 : Click finish to complete"})]}),a("section",{className:"mt-5 ml-2",children:[e("h1",{className:"mb-2",children:" Note to view the content click on view "}),e("h1",{children:" Note for now you can only upload 1 image at a time"})]})]})}const Y={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function ae(){const[c,x]=n.useState([]),[i,u]=n.useState(""),[y,h]=n.useState(""),[k,d]=n.useState(""),[C,P]=n.useState(""),[T,N]=V.useState(!1),M=()=>N(!0),U=()=>N(!1);function B(t){c.map((o,m)=>{if(t===m){const l=v(D(),`products/${i}`),r=S(l,i);r.on("state_changed",s=>{s.bytesTransferred/s.totalBytes*100},s=>{console.error(s)},async()=>{const s=await R(r.snapshot.ref),g=p(b,"DesignerPage"),O=f(g,o.post+o.month+o.page);w(O,{designer:s},{merge:!0}),console.log("success"),d("Image has been uploaded. Click view button to view image!"),setTimeout(()=>{d("")},7e3)},{merge:!0})}else return console.log("error")})}const[I,j]=n.useState(""),[F,L]=n.useState(""),[_,$]=n.useState(""),E=async t=>{try{const o=t.target.files[0];u(o.name);const m=v(D(),`products/${o.name}`),l=S(m,o);l.on("state_changed",r=>{const s=r.bytesTransferred/r.totalBytes*100;console.log(`Upload is ${s}% done`),d("Loading")},r=>{console.error(r)},async()=>{const r=await R(l.snapshot.ref),s=p(b,"DesignerPage"),g=f(s,I+F+_);w(g,{designer:r},{merge:!0}),console.log("success"),d("Image has been uploaded. Click view button to view image!"),setTimeout(()=>{d("")},7e3)},{merge:!0}),console.log("worked")}catch{console.log("error")}};function A(t){c.map((o,m)=>{if(t===m){console.log("success",o.post);const l=p(b,o.page),r=f(l,o.post+o.month);w(r,{designer:o.designer,hide:!0,color:"#00eaff",status:"Design Done",StatusText:"Design Done"},{merge:!0});const s=p(b,"DesignerPage"),g=f(s,o.post+o.month+o.page);G(g),u("")}else return console.log("error")})}return console.log(k),a(q,{children:[e(z,{}),e("section",{children:e(X,{})}),a("div",{className:"min-h-[100vh] bg-slate-600 pt-[100px]",children:[a("div",{className:"flex flex-col items-center",children:[e(W,{setDesignerData:x}),e("section",{children:c.map((t,o)=>t.hide===!0?null:a("div",{className:"flex flex-row items-center justify-end border-black border-b-2 mb-8",children:[e("img",{src:t.img,className:"w-[50px] h-[50px] rounded-md mr-4"}),a("p",{className:"text-black  bg-white text-md border-black border-2 p-2",children:[" Date : ",t.date,"-",t.month," "]}),a("p",{className:"text-black  bg-white text-md border-black border-2 p-2",children:[" Client : ",t.page," "]}),a("p",{className:`text-black text-md border-black border-2 p-2 ${t.prio==="Prio"?"bg-red-600":"bg-white"}`,children:["  ",t.prio," "]}),e("h1",{className:"cursor-pointer text-black  bg-white text-md border-black border-2 p-2  hover:scale-110 transition-transform ",onClick:()=>{M(),h(t.designer),P(t.subject)},children:" View "}),e("form",{onSubmit:()=>{B(o)},className:"designer-upload  mr-5 ml-4",children:a("label",{onClick:()=>{j(t.post),L(t.month),$(t.page)},className:`custom-file-upload cursor-pointer text-white bg-gray-800  hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-700\r
lg:w-[120px]`,children:[e("input",{type:"file",onChange:E}),"Upload Image"]})}),e("div",{children:t.designer===void 0?null:e("button",{onClick:()=>{A(o)},className:"bg-slate-800 text-white p-2 rounded-md hover:bg-gray-900 cursor-pointer",children:" Finish "})})]},o))})]}),e("div",{className:"fixed bottom-0 bg-slate-200 w-full  ",children:e("h2",{className:"text-xl ml-4",children:k})})]}),e(J,{open:T,onClose:U,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",className:"max-w-[80vw] max-h-[80vw]  ",children:e(K,{sx:Y,children:a(Q,{id:"modal-modal-title",variant:"h6",component:"h2",style:{textAlign:"center"},children:[C,e("img",{src:y})]})})})]})}export{ae as default};
