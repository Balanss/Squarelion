import{r as s,h as P,a as r,F as C,j as e,R as se,U as oe,_ as f,g as u,c as le,m as v,d as w,y as ne}from"./index-20fc51b8.js";import{N as ce,r as S,g as D,u as R,a as U}from"./Nav-8e282cc8.js";import{M as de,B as ie}from"./Box-d4231026.js";import{T as ge}from"./Typography-690cc335.js";function me({setDesignerData:d}){const b=async()=>{try{return P.collection("DesignerPage").orderBy("prio","desc").onSnapshot(y=>{const g=y.docs.map(p=>({id:p.id,...p.data()}));d(g)})}catch(i){console.error("Error fetching designer data:",i)}};s.useEffect(()=>{b()},[])}function he(){return r(C,{children:[r("div",{className:"border-yellow-500 border-t-2 mt-3 bg-slate-700",children:[e("h1",{className:"text-4xl font-sans font-bold text-slate-200 text-center mt-2",children:"Squarelion Designer Page"}),e("h6",{className:"fixed bottom-1 left-2 text-[10px] text-white",children:"V 0.1"})]}),e("div",{children:r("article",{className:"flex flex-row items-stretch justify-around w-full h-full p-10 bg-gray-100  dark:bg-slate-700",children:[r("div",{className:"block max-w-sm p-6 bg-white border border-gray-200 rounded-lg shadow hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700",children:[e("h5",{className:"mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white",children:"Click upload image"}),e("p",{className:"font-normal text-gray-700 dark:text-gray-400",children:"Step 1"})]}),r("div",{className:"block max-w-sm p-6 bg-white border border-gray-200 rounded-lg shadow hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700",children:[e("h5",{className:"mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white",children:"Click finish to complete"}),e("p",{className:"font-normal text-gray-700 dark:text-gray-400",children:"Step 2"})]}),r("div",{className:"block max-w-sm p-6 bg-white border border-gray-200 rounded-lg shadow hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700",children:[e("h5",{className:"mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white",children:"To see the instructions click on the view button"}),e("h5",{className:"mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white",children:"For now you can only upload 4 image at a time"}),e("p",{className:"font-normal text-gray-700 dark:text-gray-400",children:"Note"})]})]})})]})}const pe={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function ke(){const[d,b]=s.useState([]),[i,y]=s.useState(""),[g,p]=s.useState(""),[I,T]=s.useState(""),[ue,B]=s.useState(""),[F,M]=s.useState(""),[j,E]=s.useState(""),[L,A]=s.useState(""),[_,$]=s.useState(""),[O,N]=s.useState(""),[V,q]=s.useState(""),[be,H]=s.useState([]),[ye,Y]=s.useState([]),[z,k]=se.useState(!1),G=()=>k(!0),J=()=>k(!1);function K(a){d.map((t,m)=>{if(a===m){const o=S(D(),`products/${i}`),n=R(o,i);n.on("state_changed",l=>{l.bytesTransferred/l.totalBytes*100},l=>{console.error(l)},async()=>{const l=await U(n.snapshot.ref),h=f(w,"DesignerPage"),x=u(h,t.post+t.month+t.page);le(x,{designer:l},{merge:!0}),console.log("success"),N("Image has been uploaded. Click view button to view image!"),setTimeout(()=>{N("")},7e3)},{merge:!0})}else return console.log("error")})}const[Q,W]=s.useState(""),[X,Z]=s.useState(""),[ee,te]=s.useState(""),ae=async a=>{const t=a.target.files;if(!t||t.length>4){alert("You can only upload a maximum of 4 images at once.");return}const m=Array.from(t).map(o=>{const n=S(D(),`products/${name}/${o.name}}`),l=R(n,o);return new Promise((h,x)=>{l.on("state_changed",c=>{c.bytesTransferred/c.totalBytes*100},c=>{console.error("Upload Error:",c),x(c)},async()=>{const c=await U(l.snapshot.ref);h(c)})})});try{const o=await Promise.all(m),n={designer:o[0],designer1:o[1]||"",designer2:o[2]||"",designer3:o[3]||"",DesignedBy:g};await v(u(P,"DesignerPage",Q+X+ee),n,{merge:!0}),H(o),Y(t)}catch(o){console.error("Error updating Firestore:",o)}};function re(a){d.map((t,m)=>{if(a===m){console.log("success",t.post);const o=f(w,t.page),n=u(o,t.post+t.month);v(n,{designer:t.designer,designer1:t.designer1,designer2:t.designer2,designer3:t.designer3,hide:!0,color:"#00eaff",status:"Design Done",StatusText:"Design Done",DesignUploadedBy:g},{merge:!0});const l=f(w,"DesignerPage"),h=u(l,t.post+t.month+t.page);ne(h),y("")}else return console.log("error")})}return e(C,{children:r("div",{className:" h-[100vh]  bg-slate-800",children:[e(ce,{})," ",r("div",{className:"",children:[e(oe,{user:g,setUser:p,setUuid:T,uuid:I,setLevel:B}),e("section",{children:e(he,{})}),r("div",{className:" pt-[50px]",children:[r("div",{className:"flex flex-col items-center",children:[e(me,{setDesignerData:b}),e("section",{children:r("table",{className:"w-full text-sm text-left text-gray-300 dark:text-gray-300 shadow-md shadow-slate-800",children:[e("thead",{className:'className="text-xs  uppercase  bg-gray-700 text-gray-200',children:r("tr",{children:[e("th",{className:"px-4 py-2",children:"Image"}),e("th",{className:"px-4 py-2",children:"Date"}),e("th",{className:"px-4 py-2",children:"Client"}),e("th",{className:"px-4 py-2",children:"Priority"}),e("th",{className:"px-4 py-2",children:"Instructions"}),e("th",{className:"px-4 py-2",children:"Actions"})]})}),e("tbody",{children:d.map((a,t)=>a.hide===!0?null:r("tr",{className:"border-b bg-gray-600 border-gray-700 shadow-md hover:scale-105 shadow-black",children:[e("td",{className:"border px-4 py-2",children:e("img",{src:a.img,className:"w-[50px] h-[50px] rounded-md mr-4"})}),r("td",{className:"border px-4 py-2",children:[a.date,"-",a.month]}),e("td",{className:"border px-4 py-2",children:a.page}),e("td",{className:`border px-4 py-2 ${a.prio==="Prio"?"bg-red-600":"bg-gray-600"}`,children:a.prio}),e("td",{className:"border px-4 py-2",children:r("h1",{className:"cursor-pointer text-black  bg-white text-md border-black border-2 p-2  hover:scale-110 transition-transform ",onClick:()=>{G(),M(a.designer),E(a.designer1),A(a.designer2),$(a.designer3),q(a.subject)},children:[" ","View"," "]})}),e("td",{className:"border px-4 py-2",children:e("form",{onSubmit:()=>{K(t)},className:"designer-upload  mr-5 ml-4",children:r("label",{onClick:()=>{W(a.post),Z(a.month),te(a.page)},className:"custom-file-upload cursor-pointer text-white bg-gray-800  hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-700 lg:w-[120px]",children:[e("input",{type:"file",accept:"image/*",multiple:!0,onChange:ae}),"Upload Image"]})})}),e("td",{className:"border px-4 py-2",children:e("div",{children:a.designer===void 0?null:r("button",{onClick:()=>{re(t)},className:"bg-slate-800 text-white p-2 rounded-md hover:bg-gray-900 cursor-pointer",children:[" ","Finish"," "]})})})]},t))})]})})]}),e("div",{className:"fixed bottom-0 bg-slate-200 w-full  ",children:e("h2",{className:"text-xl ml-4",children:O})})]}),e(de,{open:z,onClose:J,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",className:"max-w-[80vw] max-h-[80vw]  ",children:e(ie,{sx:pe,children:r(ge,{id:"modal-modal-title",variant:"h6",component:"h2",style:{textAlign:"center"},children:[V,r("section",{className:"flex lg:w-[40vw] flex-wrap  gap-5 justify-center",children:[e("img",{className:"w-[300px]",src:F}),e("img",{className:"w-[300px]",src:j}),e("img",{className:"w-[300px]",src:L}),e("img",{className:"w-[300px]",src:_})]})]})})})]})," "]})})}export{ke as default};
